<div class="checklist-show" data-checklist-id="<%= checklist.id %>">
  <h2 class="content-title"><%= link_to issue_heading(issue), issue %> - <%= issue.subject %></h2>
  <div class="checklist-info" style="background: #<%= checklist.status.try(:background_color) || 'ffffff' %>">
    <div class="content">
      <div class="contextual">
        <%= link_to l(:label_checklist_edit), "javascript:;",
          :class => 'icon icon-edit edit-checklist',
          'remote-href' => checklist_edit_path(checklist)
        %>
      </div>
      <h2 class="checklist-title" style="border-left-color: #<%= checklist.priority.try(:flag_color) || '999999' %>">
        <%= checklist.tracker.try(:name) %>
        $<%= checklist.id %> - <%= checklist.subject %>
      </h2>

      <p class="author">
        <%= authoring checklist.created_on, checklist.author %>.
        <% if checklist.created_on != checklist.updated_on %>
          <%= l(:label_updated_time, time_tag(checklist.updated_on)).html_safe %>.
        <% end %>
      </p>
    </div>

    <div class="attributes">
      <%= checklist_fields_rows do |rows|
        rows.left l(:field_status), @checklist.status.name, :class => 'status'
        rows.left l(:field_importance), @checklist.importance_human, :class => 'importance'
        rows.left l(:field_priority), @checklist.priority.name, :class => 'priority'

        unless @checklist.disabled_core_fields.include?('assigned_to_id')
          rows.left l(:field_assigned_to), (@checklist.assigned_to ? link_to_user(@checklist.assigned_to) : "-"), :class => 'assigned-to'
        end

        unless @checklist.disabled_core_fields.include?('category_id') || (@checklist.category.nil? && @checklist.project.issue_categories.none?)
          rows.left l(:field_category), (@checklist.category ? @checklist.category.name : "-"), :class => 'category'
        end

        unless @checklist.disabled_core_fields.include?('fixed_version_id') || (@checklist.fixed_version.nil? && @checklist.assignable_versions.none?)
          rows.left l(:field_fixed_version), (@checklist.fixed_version ? link_to_version(@checklist.fixed_version) : "-"), :class => 'fixed-version'
        end

        unless @checklist.disabled_core_fields.include?('start_date')
          rows.right l(:field_start_date), format_date(@checklist.start_date), :class => 'start-date'
        end

        unless @checklist.disabled_core_fields.include?('due_date')
          rows.right l(:field_due_date), checklist_due_date_details(@checklist), :class => 'due-date'
        end

        unless @checklist.disabled_core_fields.include?('done_ratio')
          rows.right l(:field_done_ratio), progress_bar(@checklist.done_ratio, :legend => "#{@checklist.done_ratio}%"), :class => 'progress'
        end

        unless @checklist.disabled_core_fields.include?('estimated_hours')
          rows.right l(:field_estimated_hours), checklist_estimated_hours_details(@checklist), :class => 'estimated-hours'
        end

        if User.current.allowed_to?(:view_time_entries, @project) && @checklist.total_spent_hours > 0
          rows.right l(:label_spent_time), checklist_spent_hours_details(@checklist), :class => 'spent-time'
        end
      end %>
      <%= render_half_width_custom_fields_rows(@checklist) %>
      <%= call_hook(:view_checklists_show_details_bottom, :checklist => @checklist) %>
    </div>

    <% if checklist.description? %>
      <hr />
      <div class="description">
        <p><strong><%=l(:field_description)%></strong></p>
        <div class="wiki">
          <%= textilizable checklist, :description, :attachments => checklist.attachments %>
        </div>
      </div>
    <% end %>

    <% if checklist.attachments.any? %>
      <hr />
      <p><strong><%=l(:label_attachment_plural)%></strong></p>
      <%= link_to_attachments checklist, :thumbnails => true %>
    <% end %>

    <%= render_full_width_custom_fields_rows(checklist) %>
    <%= call_hook(:view_checklists_show_description_bottom, :checklist => checklist) %>
  </div>

  <div id="history">
    <%= render :partial => "checklists/tabs/history", :locals => { :checklist => checklist, :journals => journals } %>
  </div>

  <% html_title "#{checklist.tracker.name} $#{checklist.id}: #{checklist.subject}" %>

  <%= context_menu %>

  <% content_for :sidebar do %>
    <div></div>
  <% end %>

  <% heads_for_wiki_formatter %>
  <% include_calendar_headers_tags %>

  <% content_for :header_tags do %>
    <%= javascript_include_tag 'attachments' %>
  <% end %>
</div>
